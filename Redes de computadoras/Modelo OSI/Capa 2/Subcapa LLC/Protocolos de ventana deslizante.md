Los siguientes tres protocolos son bidireccionales y pertenecen a una clase llamada protocolos de **ventana deslizante**. Los tres difieren entre ellos en términos de eficiencia, complejidad y requerimientos de búfer, como veremos más adelante. En ellos, al igual que en todos los protocolos de ventana deslizante, cada trama de salida contiene un número de secuencia que va desde 0 hasta algún número máximo. Por lo general este valor máximo es $2^n - 1$, por lo que el número de secuencia encaja perfectamente en un campo de n bits. El protocolo de ventana deslizante de [[Protocolos elementales de enlace de datos#Stop and wait|parada y espera]] utiliza $n = 1$ y restringe los números de secuencia de 0 y 1, pero las versiones más sofisticadas pueden utilizar un n arbitrario.

La esencia de todos los protocolos de ventana deslizante es que, en cualquier instante, el emisor mantiene un conjunto de números de secuencia que corresponde a las tramas que tiene permitido enviar. Se dice que estas tramas caen dentro de la **ventana emisora**. De manera similar, el receptor mantiene una **ventana receptora** correspondiente al conjunto de tramas que tiene permitido aceptar. La ventana del emisor y la del receptor no necesitan tener los mismos límites inferior y superior, ni siquiera el mismo tamaño. En algunos protocolos las ventanas son de tamaño fijo, pero en otros pueden aumentar o reducir su tamaño con el transcurso del tiempo, a medida que se envían y reciben las tramas.

Los números de secuencia en la ventana del emisor representan las tramas que se han enviado, o que se pueden enviar pero aún no se ha confirmado su recepción. Cada vez que llega un paquete nuevo de la capa de red, se le asigna el siguiente número secuencial más alto y el extremo superior de la ventana avanza en uno. Cuando llega una confirmación de recepción, el extremo inferior avanza en uno. De esta manera, la ventana mantiene en forma continua una lista de tramas sin confirmación de recepción.

La ventana de la capa de enlace de datos receptora corresponde a las tramas que puede aceptar. Toda trama que caiga dentro de la ventana se colocará en el búfer del receptor. Cuando se reciba una trama cuyo número de secuencia sea igual al extremo inferior de la ventana, se pasará a la capa de red y la ventana se desplazará una posición. Cualquier trama que caiga fuera de la ventana se desechará. En todos estos casos se genera una confirmación de recepción subsiguiente, de manera que el emisor pueda averiguar cómo proceder. Cabe mencionar que un tamaño de ventana de 1 significa que la capa de enlace de datos sólo acepta tramas en orden, pero con ventanas más grandes esto no es así. En contraste, la capa de red siempre recibe los datos en el orden correcto, sin importar el tamaño de la ventana de la capa de enlace de datos. 

##### Tamaño de la ventana
Para encontrar un valor apropiado para el ancho de la ventana (*w*) necesitamos saber cuántas tramas pueden caber dentro del canal mientras se propagan del emisor al receptor. Esta capacidad se determina mediante el ancho de banda en bits/seg, multiplicado por el tiempo de tránsito en un sentido, mejor conocido como **[[producto de ancho de banda-retardo]]** del enlace. Podemos dividir esta cantidad entre el número de bits en una trama para expresar el producto como un número de tramas. Llamemos a esta cantidad BD. Entonces, *w* debe ser establecido a $2BD + 1$. El doble del producto ancho de banda-retardo es el número de tramas que pueden quedar pendientes si el emisor envía en forma continua tramas cuando se considera el tiempo de ida y vuelta para recibir una confirmación de recepción. El “+1” se debe a que no se enviará una trama de confirmación de recepción sino hasta recibir una trama completa. En general el ancho de la ventana debe ser a lo sumo la mitad del intervalo de números de secuencia (*n*).

Para tamaños de ventana más pequeños, el uso del enlace será de menos de 100% debido a que el emisor estará bloqueado algunas veces. Podemos escribir la utilización como la fracción de tiempo que el emisor no está bloqueado:

$$\text{utilización del enclace} \le \frac {w} {1+2BD}$$

Este valor es un límite superior ya que no considera ningún tiempo de procesamiento de tramas y supone que la trama de confirmación de recepción tiene una longitud de cero, puesto que generalmente es corta. La ecuación muestra la necesidad de tener una ventana w grande siempre que el producto ancho de banda-retardo también lo sea.

Esta técnica de mantener varias tramas en movimiento es un ejemplo de **canalización** (*pipeling*). La canalización de tramas a través de un canal de comunicación no confiable presenta problemas serios. Primero, ¿qué ocurre si una trama a la mitad de un flujo extenso se daña o pierde? Llegarán grandes cantidades de tramas sucesivas al receptor antes de que el emisor se entere de que algo anda mal. Cuando llega una trama dañada al receptor es obvio que debe descartarse pero, ¿qué debe hacer el receptor con todas las tramas correctas que le siguen? Recuerde que la capa de enlace de datos del receptor está obligada a entregar paquetes a la capa de red en secuencia.

Hay dos métodos básicos disponibles para tratar con los errores en presencia de la canalización. Una de las opciones, llamada **retroceso n**, es que el receptor simplemente descarte todas las tramas subsecuentes, sin enviar confirmaciones de recepción para las tramas descartadas. Esta estrategia corresponde a una ventana de recepción de tamaño 1. Esta estrategia puede desperdiciar bastante ancho de banda si la tasa de error es alta.

La otra estrategia general para el manejo de errores cuando las tramas se colocan en canalizaciones se conoce como **repetición selectiva**. Cuando se utiliza, si se recibe una trama dañada se descarta, pero las tramas en buen estado que se reciban después de ésa se aceptan y almacenan en el búfer. Cuando expira el temporizador del emisor, sólo se retransmite la última trama sin confirmación de recepción. Si la trama llega correctamente, el receptor puede entregar a la capa de red, en secuencia, todas las tramas que ha almacenado en el búfer. La repetición selectiva corresponde a una ventana del receptor mayor a 1. Este método puede requerir grandes cantidades de memoria en la capa de enlace de datos, si la ventana es grande.

![[RRCC_protocolos_de_ventana_deslizante_canalizacion.png]]

A menudo, la repetición selectiva se combina con el hecho de que el receptor envíe una confirmación de recepción negativa NAK (*negative aknowledgement*) al detectar un error; por ejemplo, cuando recibe un error de suma de verificación o una trama fuera de secuencia. Las NAK estimulan la retransmisión antes de que el temporizador correspondiente expire y, por lo tanto, mejoran el rendimiento.

El tamaño del buffer para un manejo de errores con repetición selectiva debe ser por lo menos el tamaño de la ventana.