Al proceso de buscar un nombre y encontrar una dirección se le conoce como **resolución de nombres**. Cuando un resolvedor tiene una consulta referente a un nombre de dominio, la pasa a uno de los servidores de nombres locales. Si el dominio que se busca está bajo la jurisdicción del servidor de nombres, como top.cs.vu-nl que está bajo cs.vu.nl, devuelve los registros de recursos autorizados. Un **registro autorizado** es uno que proviene de la autoridad que administra a ese registro y, por ende, siempre es correcto. Los registros autorizados contrastan con los **registros en caché**, que tal vez no estén actualizados.

¿Qué pasa cuando el dominio es remoto, como cuando flits.cs.vu.nl desea encontrar la dirección IP de robot.cs.washington.edu en la UW (Universidad de Washington)? En este caso y si no hay información en la caché sobre el dominio disponible en forma local, el servidor de nombres empieza una consulta remota. Esta consulta sigue el proceso que se muestra en la figura 7-6. El paso 1 muestra la consulta que se envía al servidor de nombres local. Esta consulta contiene el nombre de dominio buscado, el tipo (A) y la clase (IN).

![[RRCC_dns_resolucion_de_nombres.png]]

El siguiente paso es empezar en la parte superior de la jerarquía de nombres y preguntar a cada uno de los servidores raíz de nombres. Estos servidores tienen información sobre cada dominio de nivel superior. Esto se muestra como el paso 2 en la figura 7-6. Para contactarse con un servidor raíz, cada servidor de nombres debe tener información sobre uno o más servidores raíz de nombres. Esta información por lo general está presente en un archivo de configuración del sistema que se carga en la caché DNS al momento de iniciar el servidor DNS. En esencia, es una lista de registros NS para la raíz y los registros A correspondientes.

Es improbable que el servidor raíz de nombres conozca la dirección de una máquina en la UW, y tal vez tampoco conozca el servidor de nombres para la UW. Pero debe conocer el servidor de nombres del dominio edu, en donde se encuentra cs.washington.edu. En el paso 3 devuelve el nombre y la dirección IP para esa parte de la respuesta.

Después, el servidor de nombres local continúa su búsqueda y envía la consulta completa al servidor de nombres edu (a.edu-servers.net). Ese servidor de nombres devuelve el servidor de nombres para la UW. Esto se muestra en los pasos 4 y 5. Ahora que está más cerca, el servidor de nombres local envía la consulta al servidor de nombres de la UW (paso 6). Si el nombre de dominio buscado estaba en el Departamento de Inglés se hubiera encontrado la respuesta, puesto que la zona de la UW incluye a dicho Departamento. Pero el Departamento de Ciencias Computacionales decidió implementar su propio servidor de nombres. La consulta devuelve el nombre y la dirección IP del servidor de nombres de Ciencias Computacionales de la UW (paso 7).

Por último, el servidor de nombres local consulta al servidor de nombres de Ciencias Computacionales de la UW (paso 8). Este servidor es autorizado para el dominio cs.washington.edu, por lo que debe tener la respuesta. A continuación devuelve la respuesta final (paso 9), que el servidor de nombres local reenvía como respuesta a flits.cs.vu.nl (paso 10). Así termina la resolución del nombre.

Hay tres puntos técnicos a discutir sobre este gran escenario. Primero, en la figura 7-6 se utilizan dos mecanismos de consulta distintos. Cuando el host flits.cs.vu.nl envía su consulta al servidor de nombres local, ese servidor maneja la resolución en representación de flits hasta que pueda devolver la respuesta deseada. No devuelve respuestas parciales. Podrían ser útiles, pero no es lo que se buscaba. A este mecanismo se le denomina **consulta recursiva**.

Por otra parte, el servidor raíz de nombres (y cada servidor de nombres subsiguiente) no continúa de manera recursiva la consulta para el servidor de nombres local. Sólo devuelve una respuesta parcial y avanza a la siguiente consulta. El servidor de nombres local es responsable de continuar con la resolución, para lo cual emite otras consultas adicionales. A este mecanismo se le denomina **consulta iterativa**.

La resolución de un nombre puede implicar ambos mecanismos, como se mostró en el ejemplo anterior. Tal vez siempre parezca que es preferible una consulta recursiva, pero muchos servidores (en especial el servidor raíz) no las manejarán debido a que están muy ocupados. Las consultas iterativas imponen la carga en quien las originó. La razón de que el servidor de nombres local soporte una consulta recursiva es debido a que proporciona un servicio a los hosts en su dominio. Estos hosts no tienen que configurarse para ejecutar un servidor de nombres completo, sólo para acceder al servidor de nombres local.

El segundo punto es la caché. Todas las respuestas, incluyendo las que se devuelven, se colocan en la caché. De esta manera, si otro host cs.vu.nl genera una consulta sobre robot.cs.washington.edu, ya se sabrá la respuesta. Incluso, si un host genera una consulta sobre un host distinto en el mismo dominio, por decir galah.cs.washington.edu, esta consulta se puede enviar directamente al servidor de nombres autorizado. Asimismo, las consultas sobre otros dominios en washington.edu pueden empezar desde el servidor de nombres de washington.edu. El uso de respuestas de la caché reduce de manera considerable los pasos en una consulta y mejora el desempeño. El escenario original que bosquejamos es, de hecho, el peor caso que ocurre cuando no se coloca información útil en la caché.

Sin embargo, las respuestas de la caché no son autorizadas debido a que los cambios realizados en cs.washington.edu no se propagarán a todas las cachés en el mundo que puedan conocer sobre este nombre. Por esta razón, las entradas de la caché no deben durar mucho tiempo. Esto explica por qué se incluye el campo Tiempo_de_vida en cada registro de recursos. Si cierta máquina ha tenido la misma dirección IP durante años, puede ser seguro colocar esa información en la caché por un día. En el caso de información más volátil, podría ser más seguro purgar los registros después de unos cuantos segundos o de un minuto.

El tercer punto es el protocolo de transporte que se utiliza para las consultas y respuestas: [[UDP]]. Los mensajes DNS se envían en paquetes UDP con un formato simple para las consultas, las respuestas y los servidores de nombres que se pueden usar para continuar la resolución. No entraremos en los detalles de este formato. Si no llega una respuesta dentro de un intervalo corto, el cliente DNS repite la consulta e intenta con otro servidor para ese dominio después de unos cuantos reintentos. Este proceso está diseñado para manejar el caso en que el servidor esté fallando, así como cuando se pierde el paquete de consulta o de respuesta. Se incluye un identificador de 16 bits en cada consulta y se copia a la respuesta, de modo que un servidor de nombres pueda relacionar las respuestas con la correspondiente consulta, incluso aunque haya varias respuestas pendientes al mismo tiempo.
